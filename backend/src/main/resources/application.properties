
# Allow loading environment variables from a .env file when present
spring.config.import=optional:dotenv:

spring.application.name=portfolio
server.port=${PORT:8080}

## PostgreSQL Database Configuration
## In production (Render), prefer a single connection string via SPRING_DATASOURCE_URL.
## Example: postgres://user:pass@host:port/dbname  OR JDBC: jdbc:postgresql://host:port/dbname?sslmode=require
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}?sslmode=require}
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# Connection pool configuration for Supabase
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# Disable server-side prepared statements (fixes "prepared statement already exists" with PgBouncer)
spring.datasource.hikari.data-source-properties.dataSourceClassName=org.postgresql.ds.PGSimpleDataSource
spring.datasource.hikari.data-source-properties.prepareThreshold=0
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.connection-test-query=SELECT 1

# Logging
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# A comma-separated list of allowed frontend URLs
app.cors.allowed-origins=https://phiquangdat-git-main-dat-phis-projects.vercel.app,http://localhost:8010
